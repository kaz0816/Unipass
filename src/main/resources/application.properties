# 環境が渡す PORT で起動（Cloud Run など）。無いときは 8080
server.port=${PORT:8080}

# ===============================
# DB 設定（環境変数が無い場合はローカルの永続 H2 を使う）
# ===============================
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:h2:file:./data/review-db;MODE=PostgreSQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:sa}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:}
spring.datasource.driver-class-name=${SPRING_DATASOURCE_DRIVER:org.h2.Driver}

# ===============================
# JPA / Hibernate
# ===============================

spring.jpa.database-platform=${SPRING_JPA_DATABASE_PLATFORM:org.hibernate.dialect.H2Dialect}
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true

# ===============================
# Cloud SQL (MySQL) Connector で使う場合の環境変数例
# ===============================
# SPRING_DATASOURCE_URL=jdbc:mysql:///<DB_NAME>?cloudSqlInstance=<PROJECT:REGION:INSTANCE>&socketFactory=com.google.cloud.sql.mysql.SocketFactory&useSSL=false
# SPRING_DATASOURCE_USERNAME=<DB_USER>
# SPRING_DATASOURCE_PASSWORD=<DB_PASSWORD>
# SPRING_DATASOURCE_DRIVER=com.mysql.cj.jdbc.Driver
# SPRING_JPA_DATABASE_PLATFORM=org.hibernate.dialect.MySQLDialect

# ===============================
# ファイルアップロード（そのままでOK）
# ===============================

spring.servlet.multipart.max-file-size=20MB
spring.servlet.multipart.max-request-size=20MB
